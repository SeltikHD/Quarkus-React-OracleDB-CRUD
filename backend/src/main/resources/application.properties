# ===================================================================
# AUTOFLEX BACKEND - APPLICATION CONFIGURATION
# ===================================================================
# This file uses environment variables for sensitive configuration.
# Defaults are provided for local development only.
# ===================================================================

# Application Name
quarkus.application.name=autoflex-api

# ===================================================================
# HTTP SERVER CONFIGURATION
# ===================================================================
quarkus.http.port=${PORT:8080}
quarkus.http.cors=true
quarkus.http.cors.origins=${CORS_ORIGINS:http://localhost:5173,http://localhost:3000}
quarkus.http.cors.methods=GET,POST,PUT,DELETE,PATCH,OPTIONS
quarkus.http.cors.headers=Content-Type,Authorization,Accept
quarkus.http.cors.exposed-headers=Location

# ===================================================================
# ORACLE DATABASE CONFIGURATION
# ===================================================================
# The JDBC URL pattern for Oracle with Wallet (mTLS):
# jdbc:oracle:thin:@<tns_alias>?TNS_ADMIN=<wallet_directory>
#
# For Oracle Cloud (ATP/ADW), use the TNS alias from tnsnames.ora
# ===================================================================
quarkus.datasource.db-kind=oracle
quarkus.datasource.username=${ORACLE_USER:autoflex_user}
quarkus.datasource.password=${ORACLE_PASSWORD:}

# JDBC URL with Wallet support
# WALLET_DIR will be set by the Docker entrypoint script after decoding WALLET_BASE64
quarkus.datasource.jdbc.url=${ORACLE_JDBC_URL:jdbc:oracle:thin:@localhost:1521/FREEPDB1}

# Connection pool configuration
quarkus.datasource.jdbc.min-size=2
quarkus.datasource.jdbc.max-size=10
quarkus.datasource.jdbc.acquisition-timeout=30S
quarkus.datasource.jdbc.idle-removal-interval=2M

# ===================================================================
# HIBERNATE ORM CONFIGURATION
# ===================================================================
quarkus.hibernate-orm.database.generation=${HIBERNATE_DDL:none}
quarkus.hibernate-orm.log.sql=${LOG_SQL:false}
quarkus.hibernate-orm.physical-naming-strategy=org.hibernate.boot.model.naming.CamelCaseToUnderscoresNamingStrategy

# Oracle-specific dialect
quarkus.hibernate-orm.dialect=org.hibernate.dialect.OracleDialect

# ===================================================================
# OPENAPI / SWAGGER CONFIGURATION
# ===================================================================
quarkus.smallrye-openapi.path=/openapi
quarkus.swagger-ui.path=/swagger-ui
quarkus.swagger-ui.always-include=true
quarkus.smallrye-openapi.info-title=Autoflex API
quarkus.smallrye-openapi.info-version=1.0.0
quarkus.smallrye-openapi.info-description=ERP Module for Product and Raw Material Management

# ===================================================================
# HEALTH CHECKS
# ===================================================================
quarkus.health.extensions.enabled=true
quarkus.smallrye-health.root-path=/health

# ===================================================================
# LOGGING CONFIGURATION
# ===================================================================
quarkus.log.level=${LOG_LEVEL:INFO}
quarkus.log.category."com.autoflex".level=${APP_LOG_LEVEL:DEBUG}
quarkus.log.category."org.hibernate.SQL".level=${SQL_LOG_LEVEL:WARN}

# JSON logging for production (enabled via environment variable)
quarkus.log.console.json=${JSON_LOGGING:false}

# ===================================================================
# PROFILE-SPECIFIC CONFIGURATIONS
# ===================================================================
# Development profile
%dev.quarkus.hibernate-orm.database.generation=drop-and-create
%dev.quarkus.log.category."org.hibernate.SQL".level=DEBUG
%dev.quarkus.datasource.jdbc.url=jdbc:oracle:thin:@localhost:1521/FREEPDB1

# Test profile (uses H2 in-memory database)
%test.quarkus.datasource.db-kind=h2
%test.quarkus.datasource.jdbc.url=jdbc:h2:mem:autoflex_test;DB_CLOSE_DELAY=-1
%test.quarkus.datasource.username=sa
%test.quarkus.datasource.password=
%test.quarkus.hibernate-orm.database.generation=drop-and-create
%test.quarkus.hibernate-orm.dialect=org.hibernate.dialect.H2Dialect
